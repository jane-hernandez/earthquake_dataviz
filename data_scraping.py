import numpy as npimport pandas as pdimport requestsimport matplotlib.pyplot as pltimport jsonurl = "https://everyearthquake.p.rapidapi.com/earthquakesByDate"querystring = {"startDate":"2022-04-14","endDate":"2023-04-14","start":"1","count":"1000","type":"earthquake","magnitude":"5"}headers = {    "X-RapidAPI-Key": "38e70b15c0msh38290bbd827107cp13b4b1jsna1bfa233d75d",    "X-RapidAPI-Host": "everyearthquake.p.rapidapi.com"}    def api_caller(url,date,headers):    r = requests.request("GET", url, headers=headers, params=date)    data = json.loads(r.text)    df_temp = pd.json_normalize(data)    return(df_temp)def data_flattener(df_temp):    df_temp.columns    df_t=pd.json_normalize(df_temp['data'])    df_t.head()    df0=pd.json_normalize(df_t[0])    for i in df_t.columns:        df1=pd.json_normalize(df_t[i])        df0=df0.append(df1)    return(df0)df = pd.DataFrame()for i in range (0,2):    df_temp= api_caller(url,querystring,headers)    df = df.append(data_flattener(df_temp))    df.reset_index(inplace=True)    num = int(querystring['start']) + 1000    querystring['start'] = str(num)url = "https://everyearthquake.p.rapidapi.com/types"list_types = api_caller(url,querystring,headers)types_df = data_flattener(list_types)list_types = types_df['type'].tolist()list_types = list_types[2:5]url = "https://everyearthquake.p.rapidapi.com/earthquakesByDate"for i in list_types:    querystring = {"startDate":"2022-04-14","endDate":"2023-04-14","start":"1","count":"1000","type":f"{i}"}    for j in range(0,2):        df_temp= api_caller(url,querystring,headers)        df = df.append(data_flattener(df_temp))        df.reset_index(inplace=True)        num = int(querystring['start']) + 1000        querystring['start'] = str(num)df.drop (columns=['level_0','index'],inplace=True)df.to_csv('earthquakeAPI_data.csv',index=False)